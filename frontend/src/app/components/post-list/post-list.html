<div *ngFor="let post of posts" class="post-card" style="position: relative;">

  <!-- Ø²Ø± 3 Ù†Ù‚Ø§Ø· -->
  <button class="post-menu-btn" (click)="toggleMenu(post)">â‹®</button>

  <!-- Menu -->
  <div class="post-menu" *ngIf="post.showMenu">

    <!-- Ø¥Ø°Ø§ ÙƒØ§Ù† ØµØ§Ø­Ø¨ Ø§Ù„Ø¨ÙˆØ³Øª -->
    <ng-container *ngIf="auth.currentUser?.username === post.authorUsername; else reportButton">
      <div (click)="editPost(post)">âœï¸ Edit</div>
      <div (click)="deletePost(post.id)">ğŸ—‘ Delete</div>
    </ng-container>

    <!-- Ø¥Ø°Ø§ Ù…Ø§Ø´ÙŠ Ù‡Ùˆ ØµØ§Ø­Ø¨ Ø§Ù„Ø¨ÙˆØ³Øª -->
    <ng-template #reportButton>
       <!-- (click)="reportPost(post.id)" -->
      <div>ğŸš© Report</div>
    </ng-template>

  </div>

  <h3>By: {{ post.authorUsername }} | {{ post.createdAt | date:'short' }}</h3>
  <p>{{ post.description }}</p>

  <img *ngIf="isImage(post.mediaUrl)" [src]="'http://localhost:8080' + post.mediaUrl" alt="post image" />

  <video *ngIf="isVideo(post.mediaUrl)" controls>
    <source [src]="'http://localhost:8080' + post.mediaUrl" />
  </video>
<button (click)="toggleLike(post)" [disabled]="post.isLiking">
  {{ post.liked ? 'â¤ï¸' : 'ğŸ¤' }}
</button>
<br>
<span>{{ post.likesCount }} Like{{ post.likesCount > 1 ? 's' : '' }}</span>
<!-- Ø²Ø± Ø¨Ø§Ø´ Ù†Ø¹Ø±Ø¶Ùˆ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª -->
<button (click)="openComments(post)">ğŸ’¬ Commentaires</button>


<!-- Popup modal -->
<div class="modal-backdrop" *ngIf="selectedPostId">
  <div class="modal">
    <button class="close-btn" (click)="closeComments()">âœ–</button>
    <app-comment 
      [postId]="selectedPostId" 
      [userId]="auth.currentUser?.id">
    </app-comment>
  </div>
</div>


</div>
